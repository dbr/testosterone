import unittest
from StringIO import StringIO

from testosterone.cli.utils import BANNER, flatten, load


def detail(name_dotted):
    """Given a dotted module name, return a detail report on it's tests.
    """

    # Get a TestSuite.
    # ================

    module = load(name_dotted)
    suite = flatten(unittest.defaultTestLoader.loadTestsFromModule(module))


    # Run tests.
    # ==========
    # We only write our report to stdout after the tests have been run. This is
    # necessary because we don't want to clutter the report with an program
    # output and/or pdb sessions.

    report = StringIO(BANNER)
    runner = unittest.TextTestRunner(report)
    result = runner.run(suite)
    return report.getvalue()
